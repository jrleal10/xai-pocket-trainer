<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#10a37f">
  <meta name="description" content="Interview preparation for xAI - Master your pitch, practice objections, memorize key concepts">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <title>xAI Pocket Trainer</title>

  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
  <link rel="apple-touch-icon" href="/icons/icon-512.png">

  <style>
    /* ============================================
       SECTION 1: CSS RESET & VARIABLES
       ============================================ */

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      /* Backgrounds */
      --bg-primary: #0a0a0a;
      --bg-secondary: #1a1a1a;
      --bg-card: #242424;

      /* Accent */
      --accent-primary: #10a37f;
      --accent-secondary: #0d8a6a;

      /* Status */
      --color-success: #10a37f;
      --color-warning: #f59e0b;
      --color-error: #ef4444;

      /* Text */
      --text-primary: #ffffff;
      --text-secondary: #a0a0a0;
      --text-muted: #6b6b6b;

      /* Borders */
      --border-color: #333333;

      /* Spacing */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
    }

    /* ============================================
       SECTION 2: BASE STYLES
       ============================================ */

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Inter', sans-serif;
      font-size: 16px;
      line-height: 1.5;
      background: var(--bg-primary);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
    }

    h1 {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: var(--spacing-md);
    }

    h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: var(--spacing-md);
    }

    h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: var(--spacing-sm);
    }

    /* ============================================
       SECTION 3: LAYOUT COMPONENTS
       ============================================ */

    .container {
      max-width: 100%;
      padding: var(--spacing-md);
      min-height: 100vh;
    }

    @media (min-width: 768px) {
      .container {
        max-width: 480px;
        margin: 0 auto;
      }
    }

    .view {
      display: none;
    }

    .view.active {
      display: block;
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: var(--spacing-md);
      border: 1px solid var(--border-color);
      margin-bottom: var(--spacing-md);
    }

    .btn {
      background: var(--accent-primary);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      width: 100%;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      min-height: 44px;
      line-height: 20px;
    }

    .btn:hover {
      background: var(--accent-secondary);
      transform: translateY(-1px);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-secondary {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: var(--bg-card);
      border-color: var(--accent-primary);
    }

    /* ============================================
       SECTION 4: DASHBOARD STYLES
       ============================================ */

    .header {
      text-align: center;
      padding: var(--spacing-lg) 0;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: var(--spacing-lg);
    }

    .header h1 {
      color: var(--accent-primary);
      margin-bottom: var(--spacing-xs);
    }

    .header .subtitle {
      color: var(--text-secondary);
      font-size: 0.875rem;
    }

    .countdown-container {
      text-align: center;
      margin-bottom: var(--spacing-xl);
    }

    .countdown-container h2 {
      color: var(--text-secondary);
      font-size: 1rem;
      font-weight: 500;
      margin-bottom: var(--spacing-sm);
    }

    .countdown-display {
      font-family: 'SF Mono', 'Roboto Mono', monospace;
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent-primary);
      margin-bottom: var(--spacing-sm);
    }

    .countdown-display.today {
      color: var(--color-warning);
      font-size: 2.5rem;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .countdown-date {
      color: var(--text-muted);
      font-size: 0.875rem;
    }

    .phrase-moment {
      background: var(--bg-card);
      border-radius: 12px;
      padding: var(--spacing-lg);
      margin-bottom: var(--spacing-xl);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.3s;
      min-height: 120px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .phrase-moment:hover {
      border-color: var(--accent-primary);
      transform: translateY(-2px);
    }

    .phrase-moment h3 {
      color: var(--text-secondary);
      font-size: 0.875rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--spacing-sm);
    }

    .phrase-text {
      color: var(--text-primary);
      font-size: 1.125rem;
      line-height: 1.6;
      text-align: center;
    }

    .phrase-hint {
      color: var(--text-muted);
      font-size: 0.75rem;
      text-align: center;
      margin-top: var(--spacing-sm);
    }

    .mode-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .mode-btn {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: var(--spacing-lg);
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      color: var(--text-primary);
      display: block;
      min-height: 120px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .mode-btn:hover {
      border-color: var(--accent-primary);
      transform: translateY(-2px);
      background: var(--bg-card);
    }

    .mode-btn .icon {
      font-size: 2rem;
      margin-bottom: var(--spacing-sm);
    }

    .mode-btn .title {
      font-weight: 600;
      margin-bottom: var(--spacing-xs);
    }

    .mode-btn .duration {
      color: var(--text-muted);
      font-size: 0.75rem;
    }

    .random-pill-btn {
      grid-column: 1 / -1;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border: none;
      padding: var(--spacing-lg);
      font-size: 1.125rem;
    }

    .random-pill-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16, 163, 127, 0.3);
    }

    /* ============================================
       SECTION 5: FLASHCARDS STYLES
       ============================================ */

    .flashcard-controls {
      display: flex;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-lg);
      flex-wrap: wrap;
    }

    .flashcard-controls select {
      flex: 1;
      min-width: 150px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 12px;
      font-size: 1rem;
    }

    .flashcard-controls button {
      flex: 0 0 auto;
    }

    .progress-indicator {
      text-align: center;
      color: var(--text-secondary);
      margin-bottom: var(--spacing-md);
      font-size: 0.875rem;
    }

    .flashcard-container {
      perspective: 1000px;
      margin-bottom: var(--spacing-lg);
      min-height: 400px;
    }

    .flashcard {
      position: relative;
      width: 100%;
      min-height: 400px;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      cursor: pointer;
    }

    .flashcard.flipped {
      transform: rotateY(180deg);
    }

    .flashcard-face {
      position: absolute;
      width: 100%;
      min-height: 400px;
      backface-visibility: hidden;
      background: var(--bg-card);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      padding: var(--spacing-xl);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    .flashcard-face.front {
      border-color: var(--accent-primary);
    }

    .flashcard-face.back {
      transform: rotateY(180deg);
      border-color: var(--color-success);
    }

    .flashcard-face .category-badge {
      position: absolute;
      top: var(--spacing-md);
      right: var(--spacing-md);
      background: var(--accent-primary);
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .flashcard-face .content {
      font-size: 1.25rem;
      line-height: 1.6;
      color: var(--text-primary);
    }

    .flashcard-face.front .content {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .flashcard-actions {
      display: flex;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-lg);
    }

    .flashcard-actions button {
      flex: 1;
      padding: var(--spacing-md);
      font-size: 1rem;
    }

    .swipe-left {
      background: var(--color-warning);
    }

    .swipe-right {
      background: var(--color-success);
    }

    /* ============================================
       SECTION 6: NAVIGATION
       ============================================ */

    .back-button {
      margin-bottom: var(--spacing-lg);
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      display: inline-flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm) var(--spacing-md);
      width: auto;
    }

    .back-button:hover {
      border-color: var(--accent-primary);
      background: var(--bg-card);
    }

    /* ============================================
       SECTION 7: UTILITY CLASSES
       ============================================ */

    .hidden {
      display: none !important;
    }

    .text-center {
      text-align: center;
    }

    .text-muted {
      color: var(--text-muted);
    }

    .mb-lg {
      margin-bottom: var(--spacing-lg);
    }

    /* ============================================
       SECTION 7.5: TIMER MODE STYLES
       ============================================ */

    .timer-container {
      text-align: center;
      padding: var(--spacing-xl) 0;
    }

    .time-selector {
      display: flex;
      gap: var(--spacing-md);
      justify-content: center;
      margin-bottom: var(--spacing-xl);
    }

    .time-selector .btn {
      flex: 1;
      max-width: 100px;
    }

    .time-selector .btn.selected {
      background: var(--accent-secondary);
      border: 2px solid var(--accent-primary);
    }

    .prompt-display {
      background: var(--bg-card);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      padding: var(--spacing-xl);
      margin-bottom: var(--spacing-xl);
      min-height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .prompt-text {
      font-size: 1.5rem;
      font-weight: 600;
      line-height: 1.4;
      color: var(--text-primary);
    }

    .timer-display-large {
      font-family: 'SF Mono', 'Roboto Mono', monospace;
      font-size: 5rem;
      font-weight: 700;
      margin: var(--spacing-xl) 0;
      transition: color 0.3s ease;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: var(--bg-secondary);
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: var(--spacing-xl);
    }

    .progress-fill {
      height: 100%;
      transition: width 0.1s linear, background 0.3s ease;
      border-radius: 6px;
    }

    .timer-phase-green {
      background: var(--color-success);
    }

    .timer-phase-green .timer-display-large {
      color: var(--color-success);
    }

    .timer-phase-green .progress-fill {
      background: var(--color-success);
    }

    .timer-phase-yellow {
      background: var(--color-warning);
    }

    .timer-phase-yellow .timer-display-large {
      color: var(--color-warning);
    }

    .timer-phase-yellow .progress-fill {
      background: var(--color-warning);
    }

    .timer-phase-red {
      background: var(--color-error);
      animation: pulse-bg 0.5s ease-in-out infinite;
    }

    .timer-phase-red .timer-display-large {
      color: var(--color-error);
      animation: pulse-text 0.5s ease-in-out infinite;
    }

    .timer-phase-red .progress-fill {
      background: var(--color-error);
    }

    @keyframes pulse-bg {
      0%, 100% { background: var(--bg-primary); }
      50% { background: rgba(239, 68, 68, 0.2); }
    }

    @keyframes pulse-text {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .wrap-up-text {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--color-error);
      margin-top: var(--spacing-md);
      animation: pulse-text 0.5s ease-in-out infinite;
    }

    .review-section {
      margin-top: var(--spacing-xl);
    }

    .checklist {
      text-align: left;
      background: var(--bg-card);
      border-radius: 12px;
      padding: var(--spacing-lg);
      margin: var(--spacing-lg) 0;
    }

    .checklist-item {
      padding: var(--spacing-sm) 0;
      border-bottom: 1px solid var(--border-color);
      font-size: 0.875rem;
    }

    .checklist-item:last-child {
      border-bottom: none;
    }

    .checklist-item input[type="checkbox"] {
      margin-right: var(--spacing-sm);
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .ideal-script {
      background: var(--bg-secondary);
      border-left: 4px solid var(--accent-primary);
      padding: var(--spacing-lg);
      margin: var(--spacing-lg) 0;
      border-radius: 8px;
      white-space: pre-wrap;
      line-height: 1.6;
      font-size: 0.938rem;
    }

    .btn-group {
      display: flex;
      gap: var(--spacing-md);
      margin-top: var(--spacing-lg);
    }

    .btn-group .btn {
      flex: 1;
    }

    /* ============================================
       SECTION 8: LOADING STATE
       ============================================ */

    .loading {
      text-align: center;
      padding: var(--spacing-xl);
      color: var(--text-secondary);
    }

    .spinner {
      border: 3px solid var(--bg-secondary);
      border-top: 3px solid var(--accent-primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto var(--spacing-md);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>

  <!-- ============================================
       SECTION 1: DASHBOARD VIEW
       ============================================ -->

  <div id="dashboard" class="view active">
    <div class="container">
      <div class="header">
        <h1>üéØ xAI Pocket Trainer</h1>
        <p class="subtitle">Interview Preparation for xAI</p>
      </div>

      <div class="countdown-container">
        <h2>‚è±Ô∏è COUNTDOWN TIMER</h2>
        <div class="countdown-display" id="countdown-display">
          Loading...
        </div>
        <div class="countdown-date">at√© 29/12/2025 √†s 17:00 BRT</div>
      </div>

      <div class="phrase-moment" id="phrase-moment" onclick="nextPhrase()">
        <h3>üí¨ FRASE DO MOMENTO</h3>
        <div class="phrase-text" id="phrase-text">
          Loading...
        </div>
        <div class="phrase-hint">Tap para pr√≥xima frase</div>
      </div>

      <div class="mode-grid">
        <a href="#flashcards" class="mode-btn">
          <div class="icon">üíä</div>
          <div class="title">Flashcards</div>
          <div class="duration">2 min</div>
        </a>

        <a href="#pitch" class="mode-btn">
          <div class="icon">‚è±Ô∏è</div>
          <div class="title">45-Sec Pitch</div>
          <div class="duration">Em breve</div>
        </a>

        <a href="#objections" class="mode-btn">
          <div class="icon">üí£</div>
          <div class="title">Objections</div>
          <div class="duration">Em breve</div>
        </a>

        <a href="#vicio-police" class="mode-btn">
          <div class="icon">üö®</div>
          <div class="title">V√≠cio Police</div>
          <div class="duration">Em breve</div>
        </a>

        <a href="#random-pill" class="mode-btn random-pill-btn">
          <div class="icon">üé≤</div>
          <div class="title">RANDOM PILL</div>
          <div class="duration">D√° algo √∫til em 30seg</div>
        </a>

        <a href="#preflight" class="mode-btn">
          <div class="icon">üìã</div>
          <div class="title">Pre-Flight Checklist</div>
          <div class="duration">Dia 29</div>
        </a>
      </div>
    </div>
  </div>

  <!-- ============================================
       SECTION 2: FLASHCARDS VIEW
       ============================================ -->

  <div id="flashcards" class="view">
    <div class="container">
      <button class="btn back-button" onclick="navigateTo('dashboard')">
        ‚Üê Voltar
      </button>

      <h1 class="text-center mb-lg">üíä Flashcards</h1>

      <div class="flashcard-controls">
        <select id="category-filter" onchange="filterByCategory()">
          <option value="all">Todas as Categorias</option>
          <option value="tecnico">T√©cnico</option>
          <option value="historias">Hist√≥rias</option>
          <option value="pessoas">Pessoas</option>
          <option value="frases">Frases-Chave</option>
          <option value="dos-donts">Do's & Don'ts</option>
        </select>

        <button class="btn btn-secondary" onclick="shuffleCards()" style="width: auto; padding: 12px 20px;">
          üîÄ Shuffle
        </button>
      </div>

      <div class="progress-indicator" id="card-progress">
        Card 1 of 45
      </div>

      <div class="flashcard-container">
        <div class="flashcard" id="flashcard" onclick="flipCard()">
          <div class="flashcard-face front">
            <span class="category-badge" id="card-category">T√©cnico</span>
            <div class="content" id="card-front">
              Carregando...
            </div>
          </div>
          <div class="flashcard-face back">
            <span class="category-badge" id="card-category-back">T√©cnico</span>
            <div class="content" id="card-back">
              Carregando...
            </div>
          </div>
        </div>
      </div>

      <div class="flashcard-actions">
        <button class="btn swipe-left" onclick="markForReview()">
          ‚Üê Preciso Revisar
        </button>
        <button class="btn swipe-right" onclick="markAsKnown()">
          Sei Bem ‚Üí
        </button>
      </div>

      <div class="text-center text-muted" style="font-size: 0.875rem;">
        Ou deslize o card: ‚Üê revisar | sei bem ‚Üí
      </div>
    </div>
  </div>

  <!-- ============================================
       SECTION 3: PLACEHOLDER VIEWS (Coming Soon)
       ============================================ -->

  <div id="pitch" class="view">
    <div class="container">
      <button class="btn back-button" onclick="navigateTo('dashboard')">‚Üê Voltar</button>
      <h1 class="text-center">‚è±Ô∏è 45-Second Pitch</h1>

      <!-- Time Selection Screen -->
      <div id="pitch-setup" class="timer-container">
        <p class="text-muted text-center">Escolha o tempo de pr√°tica:</p>
        <div class="time-selector">
          <button class="time-btn" data-seconds="45">45s</button>
          <button class="time-btn active" data-seconds="60">60s</button>
          <button class="time-btn" data-seconds="90">90s</button>
        </div>

        <div class="card" style="margin-top: 2rem;">
          <h3 id="current-prompt-title">Prompt 1 de 8</h3>
          <div class="prompt-display" id="prompt-text">Tell me about yourself</div>
        </div>

        <button class="btn btn-primary" id="start-timer-btn" style="margin-top: 2rem; width: 100%; font-size: 1.25rem; padding: 1rem;">
          START
        </button>
      </div>

      <!-- Timer Running Screen -->
      <div id="pitch-running" class="timer-container" style="display: none;">
        <div class="prompt-display" id="running-prompt">Tell me about yourself</div>

        <div class="timer-display-large" id="timer-display">60</div>

        <div class="progress-bar-container">
          <div class="progress-bar" id="timer-progress"></div>
        </div>

        <div id="wrap-up-message" style="display: none; color: var(--color-error); font-weight: 700; margin-top: 1rem; font-size: 1.25rem;">
          WRAP UP!
        </div>
      </div>

      <!-- Review Screen -->
      <div id="pitch-review" class="timer-container" style="display: none;">
        <h2 class="text-center" style="color: var(--accent-primary); margin-bottom: 2rem;">‚è±Ô∏è Time's Up!</h2>

        <div class="card">
          <h3 style="margin-bottom: 1rem;">‚úÖ Checklist</h3>
          <div id="review-checklist" class="review-checklist">
            <!-- Checklist items will be inserted here -->
          </div>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 1rem;">üìù Script Ideal</h3>
          <div class="ideal-script" id="ideal-script-content">
            <!-- Ideal script will be inserted here -->
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-secondary" id="try-again-btn">Tentar Novamente</button>
          <button class="btn btn-primary" id="next-prompt-btn">Pr√≥ximo Prompt</button>
        </div>
      </div>
    </div>
  </div>

  <div id="objections" class="view">
    <div class="container">
      <button class="btn back-button" onclick="navigateTo('dashboard')">‚Üê Voltar</button>
      <h1 class="text-center">üí£ Objection Handling</h1>

      <!-- Question Screen -->
      <div id="objection-question" class="timer-container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
          <h3 id="objection-number">Obje√ß√£o 1 de 10</h3>
          <div id="objection-timer" style="font-size: 1.5rem; font-weight: 700; color: var(--color-warning);">5</div>
        </div>

        <div class="card" style="background: var(--bg-secondary); padding: 2rem; margin-bottom: 2rem;">
          <p id="objection-text" style="font-size: 1.125rem; line-height: 1.6; font-weight: 500;"></p>
        </div>

        <div id="objection-options" style="display: flex; flex-direction: column; gap: 1rem;">
          <!-- Options will be inserted here -->
        </div>

        <div style="margin-top: 2rem; text-align: center;">
          <span id="objection-score" class="text-muted">Score: 0/0</span>
        </div>
      </div>

      <!-- Feedback Screen -->
      <div id="objection-feedback" class="timer-container" style="display: none;">
        <div id="feedback-result" style="text-align: center; font-size: 2rem; font-weight: 700; margin-bottom: 2rem;">
          <!-- ‚úÖ Correto! / ‚ö†Ô∏è Parcial / ‚ùå Errado -->
        </div>

        <div class="card">
          <h3 style="margin-bottom: 1rem;">üí° Explica√ß√£o</h3>
          <p id="feedback-explanation" style="line-height: 1.6;"></p>
        </div>

        <div class="card">
          <h3 style="margin-bottom: 1rem;">üìù Script Ideal</h3>
          <div class="ideal-script" id="feedback-ideal-script"></div>
        </div>

        <div style="margin-top: 2rem; text-align: center;">
          <span id="feedback-score" class="text-muted" style="display: block; margin-bottom: 1rem;">Score: 0/0</span>
          <button class="btn btn-primary" id="next-objection-btn" style="width: 100%; max-width: 300px;">
            Pr√≥xima Obje√ß√£o
          </button>
        </div>
      </div>

      <!-- Session Complete Screen -->
      <div id="objection-complete" class="timer-container" style="display: none; text-align: center;">
        <h2 style="color: var(--accent-primary); margin-bottom: 2rem;">üéâ Sess√£o Completa!</h2>

        <div class="card">
          <h3 style="font-size: 3rem; margin-bottom: 0.5rem;" id="final-score-display">0/10</h3>
          <p class="text-muted">Corretas</p>
        </div>

        <div class="btn-group" style="margin-top: 2rem;">
          <button class="btn btn-secondary" onclick="navigateTo('dashboard')">Voltar</button>
          <button class="btn btn-primary" id="restart-objections-btn">Tentar Novamente</button>
        </div>
      </div>
    </div>
  </div>

  <div id="vicio-police" class="view">
    <div class="container">
      <button class="btn back-button" onclick="navigateTo('dashboard')">‚Üê Voltar</button>
      <h1 class="text-center">üö® V√≠cio Police</h1>
      <div class="card text-center">
        <h2>Em breve!</h2>
        <p class="text-muted">Feature dispon√≠vel na FASE 3</p>
      </div>
    </div>
  </div>

  <div id="random-pill" class="view">
    <div class="container">
      <button class="btn back-button" onclick="navigateTo('dashboard')">‚Üê Voltar</button>
      <h1 class="text-center">üé≤ Random Pill</h1>
      <div class="card text-center">
        <h2>Em breve!</h2>
        <p class="text-muted">Feature dispon√≠vel na FASE 3</p>
      </div>
    </div>
  </div>

  <div id="preflight" class="view">
    <div class="container">
      <button class="btn back-button" onclick="navigateTo('dashboard')">‚Üê Voltar</button>
      <h1 class="text-center">üìã Pre-Flight Checklist</h1>
      <div class="card text-center">
        <h2>Em breve!</h2>
        <p class="text-muted">Feature dispon√≠vel na FASE 3</p>
      </div>
    </div>
  </div>

  <!-- ============================================
       JAVASCRIPT - APP LOGIC
       ============================================ -->

  <script>
    // ============================================
    // SECTION 1: CONSTANTS & DATA
    // ============================================

    const INTERVIEW_DATE = new Date('2025-12-29T17:00:00-03:00');

    // Key phrases for "Frase do Momento"
    const keyPhrases = [
      "5 years of daily fundamental analysis at Joule",
      "Validated 7 ratios against actual defaults‚Äî5 predictive, 2 not",
      "That validation process is exactly what AI tutoring requires",
      "Modigliani-Miller: debt and equity are two views of the same company",
      "I can contribute immediately and bring differentiated expertise for future projects",
      "Ready to start immediately, 100% available",
      "Is there anything about my background that concerns you?",
      "I haven't taken the CFA, but I've APPLIED these concepts for 20 years with real money at stake",
      "Jeffrey, I know we have limited time. Is there anything about my background that we should address?",
      "First-principles thinking. Rare door into AI for finance practitioner",
      "At 45, this is not job-hopping‚Äîit's a deliberate career move",
      "The CFA tests if you can pass an exam. My experience tests if you can apply concepts when real money is at stake",
      "Growth only matters if ROIC > WACC",
      "Revenue up but CFO down = red flag",
      "Never apologize for your English. Never say 'man' or 'you know'",
      "5 years at Joule doing daily equity analysis in the investment committee"
    ];

    // Flashcards data - ALL 45 cards from PRD Section 5.1
    const flashcardsData = [
      // T√âCNICO (20 cards)
      {id: 'T1', category: 'tecnico', front: 'EV/EBITDA', back: 'Enterprise Value / EBITDA. Capital-structure neutral. Use for cross-company comparison. Triangulate with EV/EBIT and EV/FCF.'},
      {id: 'T2', category: 'tecnico', front: 'Enterprise Value', back: 'EV = Market Cap + Net Debt + Minority Interest + Preferred. Value to ALL capital providers.'},
      {id: 'T3', category: 'tecnico', front: 'ROIC', back: 'NOPAT / Invested Capital. "Growth only matters if ROIC > WACC." Sacred at Joule.'},
      {id: 'T4', category: 'tecnico', front: 'PEG Ratio', back: 'P/E / Growth Rate. Central to GARP. PEG=1 is fair. PEG<1 potentially undervalued.'},
      {id: 'T5', category: 'tecnico', front: 'Cash Conversion Cycle', back: 'DSO + DIO - DPO. Red flag: DSO growing faster than revenue = collection problems.'},
      {id: 'T6', category: 'tecnico', front: 'Modigliani-Miller', back: "Capital structure doesn't affect firm value. Debt and equity = two views of same company. What matters: assets and cash flows."},
      {id: 'T7', category: 'tecnico', front: 'WACC', back: '(E/V √ó Ke) + (D/V √ó Kd √ó (1-t)). Where Ke = Rf + Œ≤ √ó MRP.'},
      {id: 'T8', category: 'tecnico', front: 'Free Cash Flow', back: "FCFF = EBIT(1-t) + D&A - CapEx - ŒîNWC. What's available to all capital providers."},
      {id: 'T9', category: 'tecnico', front: 'DCF Terminal Value', back: 'Gordon Growth: FCF √ó (1+g) / (WACC-g). Often 60-80% of total value. Highly sensitive to assumptions.'},
      {id: 'T10', category: 'tecnico', front: 'Interest Coverage', back: 'EBIT / Interest Expense. Ability to pay interest. Below 2x = concerning.'},
      {id: 'T11', category: 'tecnico', front: 'Net Debt/EBITDA', back: '(Debt - Cash) / EBITDA. Leverage net of cash. Bankers love this.'},
      {id: 'T12', category: 'tecnico', front: 'ROE', back: 'Net Income / Equity. Can be inflated by leverage. Use with ROIC.'},
      {id: 'T13', category: 'tecnico', front: 'Gross Margin', back: 'Gross Profit / Revenue. Pricing power and COGS efficiency.'},
      {id: 'T14', category: 'tecnico', front: 'Operating Margin', back: 'EBIT / Revenue. Core profitability. Operating leverage.'},
      {id: 'T15', category: 'tecnico', front: 'Earnings Quality Red Flags', back: 'Revenue ‚Üë but CFO ‚Üì. Receivables growing > revenue. Frequent "one-time" charges.'},
      {id: 'T16', category: 'tecnico', front: 'DSO (Days Sales Outstanding)', back: '(Receivables / Revenue) √ó 365. Days to collect. Rising = bad sign.'},
      {id: 'T17', category: 'tecnico', front: 'Brazil Interest Rates', back: 'Currently ~15%. Makes equity unattractive vs. government bonds. Structural discounts.'},
      {id: 'T18', category: 'tecnico', front: 'Common AI Error: P/EBITDA', back: 'Wrong! Should be EV/EBITDA. P/ is equity level, EBITDA is firm level. Inconsistent.'},
      {id: 'T19', category: 'tecnico', front: 'Common AI Error: US Rates for Brazil', back: 'Wrong! Brazil = 15%, not 2-3%. WACC is completely different.'},
      {id: 'T20', category: 'tecnico', front: 'GARP', back: "Growth at Reasonable Price. Joule's strategy. Balance growth with valuation discipline."},

      // HIST√ìRIAS (7 cards)
      {id: 'H1', category: 'historias', front: 'Joule Story - Short', back: '5 years, GARP fund, daily investment committee, DCF validation, multiple analysis, earnings quality debates. "Prove it to me" culture.'},
      {id: 'H2', category: 'historias', front: 'Joule Story - Key Numbers', back: '5 years as partner. +38.64% YTD 2025 vs Ibov +31.29%. 18+ year track record.'},
      {id: 'H3', category: 'historias', front: 'ABC Story - Short', back: 'Validated rating model. 7 fundamental ratios analyzed. 5 predictive, 2 not. Built logistic regression. Central Bank approved.'},
      {id: 'H4', category: 'historias', front: 'ABC Story - Detail', back: 'Central Bank said model too judgmental. Gathered 5 years data. Analyzed each ratio vs defaults. Found 5/7 useful. Built automated model with override option. BC approved and praised.'},
      {id: 'H5', category: 'historias', front: 'Emerging Markets - Short', back: 'Brazil: 15% rates, small private markets, structural equity discounts. Can help reduce US bias in Grok.'},
      {id: 'H6', category: 'historias', front: 'Emerging Markets - Connection to Jeffrey', back: 'Jeffrey has EM Fixed Income background (until 2018), worked with LatAm clients. Natural connection point.'},
      {id: 'H7', category: 'historias', front: '"Cheap Multiple" Trap (Joule)', back: 'Retailer at 6x vs peers at 10x. Thesis: digital margin expansion. Challenge: digital needs capex. Found: DSO rising = extending terms. Passed. Market was right.'},

      // PESSOAS (4 cards)
      {id: 'P1', category: 'pessoas', front: 'Jeffrey Weichsel', back: 'Human Data Manager @ xAI. Ex-Scale AI. Ex-EM Fixed Income (LatAm clients until 2018). Connecticut College. Palo Alto.'},
      {id: 'P2', category: 'pessoas', front: 'Adriana', back: 'Team Lead, Finance Vertical. Equity analyst background. Said: "Current focus is fundamental analysis." "Adventurous spirit."'},
      {id: 'P3', category: 'pessoas', front: 'Michael', back: 'First interviewer. Behavioral focus. Liked Bear Stearns story, Markowitz testing.'},
      {id: 'P4', category: 'pessoas', front: 'xAI Team', back: 'Growing to 100+. Finance vertical. Projects: CFA training, synthetic IB deals, virtual data rooms.'},

      // FRASES-CHAVE (8 cards)
      {id: 'F1', category: 'frases', front: 'Opening Line', back: '5 years of daily fundamental analysis at Joule, hands-on model validation at ABC, ready to start immediately.'},
      {id: 'F2', category: 'frases', front: 'ABC Pitch', back: 'Validated 7 ratios against actual defaults. Found 5 predictive, 2 not. Built automated model. Central Bank approved.'},
      {id: 'F3', category: 'frases', front: 'Closing Question', back: 'Is there anything about my background that concerns you, or any question I can address right now?'},
      {id: 'F4', category: 'frases', front: 'Why xAI', back: 'First-principles thinking. Rare door into AI for finance practitioner. Want to build, not join.'},
      {id: 'F5', category: 'frases', front: 'Credit vs Equity', back: 'Modigliani-Miller: debt and equity are two views of the same company.'},
      {id: 'F6', category: 'frases', front: 'Value Proposition', back: 'I can contribute to current fundamental analysis projects immediately, AND bring differentiated expertise for future risk projects.'},
      {id: 'F7', category: 'frases', front: 'Availability', back: '100% available. Transitioned out of Joule. Ready to start immediately.'},
      {id: 'F8', category: 'frases', front: 'No CFA Response', back: "I haven't taken the CFA, but I've APPLIED these concepts for 20 years with real money at stake."},

      // DO'S AND DON'TS (6 cards)
      {id: 'D1', category: 'dos-donts', front: "Don't Say", back: '"man", "you know", "basically", "sorry", "my poor English"'},
      {id: 'D2', category: 'dos-donts', front: "Don't Do", back: 'Apologize. Mention Joule office. Focus on credit first. Over-explain.'},
      {id: 'D3', category: 'dos-donts', front: 'Do Say', back: '"Joule", "ABC", "fundamental analysis", "validation", "immediately"'},
      {id: 'D4', category: 'dos-donts', front: 'Do', back: 'Lead with Joule + ABC. Keep under 60 seconds. Ask closing question.'},
      {id: 'D5', category: 'dos-donts', front: "If You Don't Know", back: '"I don\'t have direct experience with that, but my instinct based on Joule/ABC is..."'},
      {id: 'D6', category: 'dos-donts', front: 'End Statements', back: "Downward inflection. Sounds confident. Don't trail off or upspeak."}
    ];

    // 45-Second Pitch Prompts - From PRD Section 4.3.6
    const pitchPrompts = [
      {
        id: 1,
        prompt: "Tell me about yourself",
        checklist: [
          "Mentioned Joule (5 years, daily fundamental analysis)?",
          "Mentioned ABC (validation project)?",
          "Stated availability/readiness?",
          "Under 60 seconds?",
          "No apologies, 'man', or 'you know'?"
        ],
        idealScript: `5 years of daily fundamental analysis at Joule‚Äîa GARP fund in Brazil. I was in the investment committee doing DCF models, debating earnings quality, challenging theses.

Before that, at ABC-Brasil, I validated their credit rating model. They had 7 fundamental ratios but didn't know which were predictive. I analyzed 5 years of data against actual defaults. Found 5 ratios were useful, 2 weren't. Built a logistic regression model. Central Bank approved it.

Now I'm ready to start immediately. 100% available. This role at xAI is exactly what I want‚Äîapplying first-principles thinking to teach finance through AI.`
      },
      {
        id: 2,
        prompt: "Why xAI?",
        checklist: [
          "Mentioned 'first-principles thinking'?",
          "Connected to your background?",
          "Showed understanding of xAI's mission?",
          "Expressed genuine excitement?",
          "Avoided generic answers?"
        ],
        idealScript: `First-principles thinking.

xAI is building AI from the ground up using reasoning, not pattern-matching. That's exactly what I did at ABC: took 7 ratios, didn't trust conventional wisdom, validated each one against real defaults.

This is a rare door into AI for someone with 20+ years of finance. I don't want to join some fintech that uses GPT via API. I want to BUILD the thing that teaches finance. That's only possible here.`
      },
      {
        id: 3,
        prompt: "Tell me about your fundamental analysis experience",
        checklist: [
          "Mentioned Joule specifics (5 years, investment committee)?",
          "Gave concrete example (ratio, red flag, or story)?",
          "Showed depth beyond surface-level?",
          "Connected to xAI's needs?",
          "Concise and confident?"
        ],
        idealScript: `5 years at Joule doing daily equity analysis in the investment committee.

GARP strategy‚ÄîGrowth at Reasonable Price. We'd triangulate: EV/EBITDA, EV/EBIT, EV/FCF. Sacred rule: "Growth only matters if ROIC > WACC."

One red flag I learned to spot: revenue up but cash flow from operations down. Usually means they're extending payment terms to juice sales. Or capitalizing expenses. The market eventually catches it.

That validation mindset‚Äîproving things with data rather than trusting headlines‚Äîis exactly what AI tutoring needs for finance.`
      },
      {
        id: 4,
        prompt: "What's your most relevant experience for this role?",
        checklist: [
          "Led with ABC validation project?",
          "Explained the validation process?",
          "Connected to AI training?",
          "Mentioned specific numbers (7 ratios, 5 predictive)?",
          "Under 60 seconds?"
        ],
        idealScript: `The ABC rating model validation.

Central Bank said our model was too judgmental. So I gathered 5 years of financial data and matched it against actual defaults.

Analyzed 7 fundamental ratios one by one:
- Interest Coverage ‚Üí Highly predictive
- Net Debt/EBITDA ‚Üí Predictive
- ROE ‚Üí NOT predictive (can be gamed with leverage)
- ROIC ‚Üí Predictive
- And so on...

Found 5 were useful, 2 weren't. Built a logistic regression model with weights. Central Bank approved and praised the rigor.

That validation process‚Äîtesting whether concepts actually predict outcomes‚Äîis EXACTLY what training AI to tutor finance requires. You can't just feed it textbook formulas. You need someone who knows what works in practice.`
      },
      {
        id: 5,
        prompt: "Tell me about the ABC rating model project",
        checklist: [
          "Explained the problem (Central Bank objection)?",
          "Described your solution (data validation)?",
          "Gave specific results (5/7 ratios predictive)?",
          "Mentioned outcome (Central Bank approval)?",
          "Connected to xAI?"
        ],
        idealScript: `ABC had a credit rating model using 7 fundamental ratios: Interest Coverage, Net Debt/EBITDA, ROE, ROIC, Cash Conversion Cycle, Gross Margin, Operating Margin.

Central Bank said it was too judgmental‚Äîwe couldn't prove which ratios mattered.

So I gathered 5 years of financial statements from our corporate clients and matched them against who actually defaulted.

Tested each ratio:
‚úÖ Interest Coverage: Companies with <2x almost always defaulted
‚úÖ Net Debt/EBITDA: High leverage predicted trouble
‚ùå ROE: NOT predictive (private companies game this with leverage)
‚úÖ ROIC: Very predictive
‚ùå Gross Margin: Alone, not useful

Built logistic regression with the 5 useful ratios. Central Bank approved. Model ran for years.

This taught me: in finance, conventional wisdom often fails. You validate with data. That's what xAI needs for Grok.`
      },
      {
        id: 6,
        prompt: "You've done credit and equity analysis. How are they different?",
        checklist: [
          "Mentioned Modigliani-Miller?",
          "Explained 'two views of same company'?",
          "Showed depth beyond surface answer?",
          "Avoided saying credit is 'easier' or 'harder'?",
          "Confident and concise?"
        ],
        idealScript: `Modigliani-Miller principle: debt and equity are two views of the same company.

Credit asks: "Will they pay me back?" Focus on downside protection, covenants, asset coverage.

Equity asks: "Will this grow?" Focus on upside, ROIC > WACC, terminal value assumptions.

But you're analyzing the same cash flows. If you understand enterprise value and capital structure, you can do both.

At Joule, I'd decompose: EV = Market Cap + Net Debt. Equity is a residual claim. Credit is senior. But both depend on the business generating cash.

At ABC, I used the same fundamental analysis‚Äîjust focused on "can they cover interest?" instead of "will they grow earnings?"`
      },
      {
        id: 7,
        prompt: "Why are you leaving Joule?",
        checklist: [
          "Framed positively (moving TOWARD xAI, not AWAY from Joule)?",
          "Expressed respect for Joule?",
          "Emphasized deliberate choice?",
          "Connected to career transition at 45?",
          "No negativity or complaints?"
        ],
        idealScript: `I'm not leaving because something's wrong at Joule‚Äîit's been an incredible 5 years. +38% YTD, rigorous investment process, learned a ton.

But at 45, this is my last chance to move into AI. If I wait 2-3 more years, that door closes.

xAI is the only place where a finance practitioner can contribute to BUILDING the AI, not just using it. I don't want to join a fintech that calls OpenAI's API. I want to be where the reasoning is happening.

This is a deliberate, one-time career move. I've transitioned out of Joule. I'm 100% available and ready to start immediately.`
      },
      {
        id: 8,
        prompt: "Do you have any questions for me?",
        checklist: [
          "Asked closing question (concerns about background)?",
          "Showed confidence and openness?",
          "Avoided generic questions?",
          "Ended strong?",
          "Ready to address concerns directly?"
        ],
        idealScript: `Yes‚ÄîJeffrey, I know we have limited time.

Is there anything about my background that concerns you, or any question I can address right now?

[PAUSE - let him respond]

[If no concerns:]
"Great. I'm excited about this role and ready to start immediately."`
      }
    ];

    // Objection Handling Questions - From PRD Section 4.5.4 + Section 12.3
    const objections = [
      {
        id: 1,
        objection: "Why should we hire you instead of someone with a CFA?",
        options: [
          { text: "I haven't taken the CFA, but I can study for it if needed", score: 0 },
          { text: "I've applied these concepts for 20 years with real money at stake", score: 2 },
          { text: "The CFA is not that important for AI training work", score: 0 }
        ],
        correctIndex: 1,
        explanation: "The CFA tests if you can pass an exam. Your experience tests if you can apply concepts when real money is at stake. That's what xAI needs: someone who knows what works in practice.",
        idealScript: `I haven't taken the CFA, but I've APPLIED these concepts for 20 years with real money at stake.

The CFA tests if you can pass an exam. My experience tests if you can actually use ROIC, WACC, DCF‚Äîwhen a wrong model costs the fund millions.

At Joule, I wasn't regurgitating textbook formulas. I was in the investment committee defending: "This company's ROIC is 18%, WACC is 12%, trading at 8x EV/EBITDA‚Äîwe should buy."

For training Grok to tutor finance, you need someone who knows what actually predicts outcomes. That's validation, not memorization.`
      },
      {
        id: 2,
        objection: "You're 45. Won't you get bored doing data labeling?",
        options: [
          { text: "I won't get bored, I'm very motivated", score: 0 },
          { text: "This isn't data labeling‚Äîit's validating what finance concepts AI should learn", score: 2 },
          { text: "I'll work on other projects too, not just this", score: 1 }
        ],
        correctIndex: 1,
        explanation: "Reframe the role. You're not 'labeling data'‚Äîyou're validating financial knowledge for AI. That's exactly what you did at ABC with the rating model.",
        idealScript: `This isn't data labeling‚Äîit's validating what finance concepts AI should learn.

That's exactly what I did at ABC: Central Bank said our rating model was too judgmental. I validated 7 ratios against actual defaults. Found 5 were predictive, 2 weren't.

Here, I'd be doing the same: testing if Grok's understanding of ROIC, DCF, earnings quality actually matches what works in practice.

At 45, I'm not looking for novelty. I'm looking for IMPACT. Teaching AI to understand finance correctly‚Äîthat's a 10-year project I want to commit to.`
      },
      {
        id: 3,
        objection: "Why are you really leaving Joule? There must be a problem.",
        options: [
          { text: "There's no problem, I just want to try something new", score: 0 },
          { text: "Joule is great, but at 45, this is my last window to move into AI", score: 2 },
          { text: "I've learned everything I can at Joule and need a new challenge", score: 1 }
        ],
        correctIndex: 1,
        explanation: "Be honest but positive. Joule is excellent, but the AI opportunity has a time limit. Frame it as a deliberate career choice, not dissatisfaction.",
        idealScript: `Joule is great‚Äî+38% YTD, rigorous process, learned a ton. There's no problem.

But at 45, if I want to move into AI, this is my last window. In 2-3 years, that door closes.

xAI is the only place where a finance practitioner can contribute to BUILDING the AI, not just using it via API.

This is a deliberate, one-time career move. I've transitioned out of Joule cleanly. I'm 100% available and ready to start immediately.`
      },
      {
        id: 4,
        objection: "We have people with PhDs. You'll be the least educated person on the team.",
        options: [
          { text: "I learn quickly and can keep up", score: 0 },
          { text: "PhDs are valuable, but this role needs someone who's lived finance daily for 20 years", score: 2 },
          { text: "Education doesn't matter as much as experience", score: 1 }
        ],
        correctIndex: 1,
        explanation: "Acknowledge their expertise but highlight your unique value: practical validation of financial concepts.",
        idealScript: `PhDs are valuable‚ÄîI respect that expertise.

But this role needs someone who's lived finance daily for 20 years. Someone who knows that "Revenue ‚Üë but CFO ‚Üì" is a red flag because they've seen companies fail from it.

A PhD can explain Modigliani-Miller theoretically. I can explain why it matters when you're deciding if debt or equity is mispriced.

At ABC, I validated which ratios predict defaults. At Joule, I validated which companies' growth is sustainable. That's the validation xAI needs for Grok.

Different skill sets. Complementary.`
      },
      {
        id: 5,
        objection: "Your English isn't perfect. That might be a problem for writing training data.",
        options: [
          { text: "I'll work on improving my English", score: 0 },
          { text: "My English is clear for technical finance. I've written reports for 20 years.", score: 2 },
          { text: "I can have someone review my writing", score: 1 }
        ],
        correctIndex: 1,
        explanation: "Never apologize for your English. Emphasize that technical finance communication is clear and you've done it professionally for decades.",
        idealScript: `My English is clear for technical finance. I've written investment committee memos, rating reports, and client analyses for 20 years.

For training Grok, you don't need literary prose. You need: "ROIC > WACC means value creation." "DSO rising faster than revenue = collection risk."

That's technical precision. That's what I do.

If there's a specific concern about my writing, I'm happy to do a sample task. But I've communicated complex finance in English daily for two decades.`
      },
      {
        id: 6,
        objection: "This role is in Palo Alto. You're in Brazil. How will that work?",
        options: [
          { text: "I can work remotely or relocate if needed", score: 1 },
          { text: "I'm relocating to the US. Timing is flexible based on when you need me.", score: 2 },
          { text: "Many companies work remotely now, it shouldn't be a problem", score: 0 }
        ],
        correctIndex: 1,
        explanation: "Show commitment and flexibility. You're willing to relocate, and you can adapt to their timeline.",
        idealScript: `I'm relocating to the US. Timing is flexible based on when you need me.

If you need me to start remotely while I arrange relocation‚ÄîI can do that. I'm in Brazil (UTC-3), so overlap with Palo Alto is manageable.

If you need me on-site from day 1‚ÄîI can arrange that too. My Joule transition is complete. I'm 100% available.

Location is not a blocker. I'm committed to making this work.`
      },
      {
        id: 7,
        objection: "You've been at Joule for 5 years. Before that, 15 years at ABC. You don't job-hop. Why start now?",
        options: [
          { text: "I'm not job-hopping, this is a special opportunity", score: 1 },
          { text: "At 45, this isn't job-hopping‚Äîit's a deliberate, one-time career transition into AI", score: 2 },
          { text: "I stay long-term when I'm committed, and I'm committed to xAI", score: 1 }
        ],
        correctIndex: 1,
        explanation: "Reframe as a strength. Your stability shows commitment. This move is exceptional and deliberate.",
        idealScript: `Exactly‚Äîat 45, this isn't job-hopping. It's a deliberate, one-time career transition.

I stayed at ABC for 15 years because I was building something: their credit risk framework. I stayed at Joule for 5 years because the GARP strategy was world-class.

Now I'm moving to xAI because at 45, this is my last chance to contribute to building AI. If I don't do this now, I'll be analyzing stocks until retirement.

My track record shows: when I commit, I stay. I'm committing to xAI long-term‚Äîthis is a 10-year decision for me.`
      },
      {
        id: 8,
        objection: "We need someone who can start immediately. Can you really do that?",
        options: [
          { text: "Yes, I can start within 2-3 weeks", score: 1 },
          { text: "Yes. I've transitioned out of Joule. I'm 100% available and ready to start immediately.", score: 2 },
          { text: "I'll need to give notice, but I'll make it work", score: 0 }
        ],
        correctIndex: 1,
        explanation: "Remove all doubt. You're ready NOW. No notice period, no delays.",
        idealScript: `Yes. I've transitioned out of Joule cleanly. I'm 100% available.

No notice period. No loose ends. If you say "start Monday," I'll be there Monday.

I took this transition seriously because I'm serious about xAI. I didn't want to be in a position where I'm negotiating notice periods or wrapping up projects.

I'm ready to start immediately.`
      },
      {
        id: 9,
        objection: "Sell me on why I should hire a Partner from a Brazilian fund to do AI work. (Sales Guy Test)",
        options: [
          { text: "I have unique experience that combines finance and validation skills", score: 1 },
          { text: "You should hire me because I can validate if Grok's finance knowledge actually works‚ÄîI've done it for 20 years with real money at stake", score: 2 },
          { text: "I'm passionate about AI and willing to learn whatever is needed", score: 0 }
        ],
        correctIndex: 1,
        explanation: "This is a test of confidence and clarity. Give a direct, compelling answer focused on your unique value proposition.",
        idealScript: `You should hire me because I can validate if Grok's finance knowledge actually works‚Äîand I've done exactly that for 20 years with real money at stake.

At ABC, I validated 7 financial ratios against real defaults. Found 5 predictive, 2 not. Built a model. Central Bank approved.

At Joule, I validated companies' growth stories. "ROIC > WACC?" "Revenue up but CFO down‚Äîwhy?" Millions rode on getting it right.

For training Grok to tutor finance, you need someone who knows: What predicts outcomes? What's textbook BS? What actually matters when money's at risk?

That's me. That's what I've done daily for 20 years. And I can start immediately.`
      },
      {
        id: 10,
        objection: "This role involves a lot of repetitive work. You'll get bored in 3 months. (Boredom Test)",
        options: [
          { text: "I don't get bored easily, I'm very disciplined", score: 0 },
          { text: "I spent 15 years analyzing the same 200 companies at ABC. I don't get bored‚ÄîI get precise.", score: 2 },
          { text: "I'll find ways to make the work interesting", score: 0 }
        ],
        correctIndex: 1,
        explanation: "Use your track record as proof. You've done long-term, detail-oriented work and thrived.",
        idealScript: `I spent 15 years at ABC analyzing credit risk for the same portfolio of 200 companies. Quarterly reviews. Same ratios. Same spreadsheets.

I didn't get bored‚ÄîI got precise. I learned which tiny changes in DSO predicted trouble 6 months later.

At Joule, I analyzed the same 40-stock portfolio for 5 years. Daily investment committee. Same questions: "ROIC > WACC?" "Is growth sustainable?"

Repetitive? Yes. Boring? No. Because precision matters. One ratio wrong = millions lost.

For xAI, teaching Grok to understand ROIC correctly‚Äîthat's repetitive validation work. But if Grok gets it wrong, it teaches millions of students wrong.

I'm built for this. I don't get bored. I get it right.`
      }
    ];

    // ============================================
    // SECTION 2: STATE MANAGEMENT
    // ============================================

    const state = {
      currentView: 'dashboard',
      currentCardIndex: 0,
      currentPhraseIndex: 0,
      filteredCards: [...flashcardsData],
      reviewNeeded: [],
      knownCards: [],
      isCardFlipped: false,
      // Timer state
      selectedTime: 60,
      currentPromptIndex: 0,
      timerRunning: false,
      timerStartTime: null,
      timerInterval: null,
      // Objections state
      currentObjectionIndex: 0,
      objectionsAnswered: 0,
      objectionsCorrect: 0,
      objectionTimer: null,
      objectionTimeRemaining: 5
    };

    // ============================================
    // SECTION 3: NAVIGATION
    // ============================================

    function navigateTo(viewId) {
      // Hide all views
      document.querySelectorAll('.view').forEach(view => {
        view.classList.remove('active');
      });

      // Show target view
      const targetView = document.getElementById(viewId);
      if (targetView) {
        targetView.classList.add('active');
        state.currentView = viewId;
        window.location.hash = viewId;

        // Initialize view-specific logic
        if (viewId === 'flashcards') {
          initFlashcards();
        } else if (viewId === 'pitch') {
          initPitchTimer();
        } else if (viewId === 'objections') {
          initObjections();
        }
      }
    }

    // Handle browser back/forward
    window.addEventListener('hashchange', () => {
      const hash = window.location.hash.slice(1) || 'dashboard';
      if (hash !== state.currentView) {
        navigateTo(hash);
      }
    });

    // ============================================
    // SECTION 4: COUNTDOWN TIMER
    // ============================================

    function updateCountdown() {
      const now = new Date();
      const diff = INTERVIEW_DATE - now;

      const countdownEl = document.getElementById('countdown-display');

      if (diff <= 0) {
        countdownEl.textContent = 'ENTREVISTA AGORA! üéØ';
        countdownEl.classList.add('today');
        return;
      }

      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

      // Check if today
      const isToday = days === 0;

      if (isToday) {
        countdownEl.textContent = `HOJE! Faltam ${hours}h ${minutes}min`;
        countdownEl.classList.add('today');
      } else {
        countdownEl.textContent = `${days} dias, ${hours} horas, ${minutes} minutos`;
        countdownEl.classList.remove('today');
      }
    }

    // Update countdown every minute
    setInterval(updateCountdown, 60000);

    // ============================================
    // SECTION 5: PHRASE ROTATION
    // ============================================

    function displayPhrase() {
      const phraseEl = document.getElementById('phrase-text');
      phraseEl.textContent = keyPhrases[state.currentPhraseIndex];
    }

    function nextPhrase() {
      state.currentPhraseIndex = (state.currentPhraseIndex + 1) % keyPhrases.length;
      displayPhrase();
    }

    // Auto-rotate phrases every 30 seconds
    let phraseInterval = setInterval(nextPhrase, 30000);

    // Reset interval when user manually clicks
    document.getElementById('phrase-moment')?.addEventListener('click', () => {
      clearInterval(phraseInterval);
      phraseInterval = setInterval(nextPhrase, 30000);
    });

    // ============================================
    // SECTION 6: FLASHCARDS LOGIC
    // ============================================

    function initFlashcards() {
      loadState();
      applyFilter();
      displayCurrentCard();
    }

    function displayCurrentCard() {
      if (state.filteredCards.length === 0) {
        document.getElementById('card-front').textContent = 'Nenhum card nesta categoria';
        document.getElementById('card-back').textContent = 'Selecione outra categoria';
        return;
      }

      const card = state.filteredCards[state.currentCardIndex];
      const categoryLabels = {
        'tecnico': 'T√©cnico',
        'historias': 'Hist√≥rias',
        'pessoas': 'Pessoas',
        'frases': 'Frases-Chave',
        'dos-donts': "Do's & Don'ts"
      };

      // Update progress
      document.getElementById('card-progress').textContent =
        `Card ${state.currentCardIndex + 1} de ${state.filteredCards.length}`;

      // Update category badges
      const categoryLabel = categoryLabels[card.category] || card.category;
      document.getElementById('card-category').textContent = categoryLabel;
      document.getElementById('card-category-back').textContent = categoryLabel;

      // Update content
      document.getElementById('card-front').textContent = card.front;
      document.getElementById('card-back').textContent = card.back;

      // Reset flip state
      state.isCardFlipped = false;
      document.getElementById('flashcard').classList.remove('flipped');
    }

    function flipCard() {
      state.isCardFlipped = !state.isCardFlipped;
      const flashcard = document.getElementById('flashcard');
      if (state.isCardFlipped) {
        flashcard.classList.add('flipped');
      } else {
        flashcard.classList.remove('flipped');
      }
    }

    function nextCard() {
      state.currentCardIndex = (state.currentCardIndex + 1) % state.filteredCards.length;
      displayCurrentCard();
    }

    function markForReview() {
      const card = state.filteredCards[state.currentCardIndex];
      if (!state.reviewNeeded.includes(card.id)) {
        state.reviewNeeded.push(card.id);
      }
      saveState();
      nextCard();
    }

    function markAsKnown() {
      const card = state.filteredCards[state.currentCardIndex];
      if (!state.knownCards.includes(card.id)) {
        state.knownCards.push(card.id);
      }
      // Remove from review needed if it was there
      state.reviewNeeded = state.reviewNeeded.filter(id => id !== card.id);
      saveState();
      nextCard();
    }

    function filterByCategory() {
      const filter = document.getElementById('category-filter').value;

      if (filter === 'all') {
        state.filteredCards = [...flashcardsData];
      } else {
        state.filteredCards = flashcardsData.filter(card => card.category === filter);
      }

      // Prioritize review-needed cards
      const reviewCards = state.filteredCards.filter(card => state.reviewNeeded.includes(card.id));
      const otherCards = state.filteredCards.filter(card => !state.reviewNeeded.includes(card.id));
      state.filteredCards = [...reviewCards, ...reviewCards, ...otherCards]; // Show review cards 2x

      state.currentCardIndex = 0;
      displayCurrentCard();
      saveState();
    }

    function applyFilter() {
      const savedFilter = localStorage.getItem('xai-category-filter');
      if (savedFilter) {
        document.getElementById('category-filter').value = savedFilter;
        filterByCategory();
      } else {
        filterByCategory();
      }
    }

    function shuffleCards() {
      // Fisher-Yates shuffle
      for (let i = state.filteredCards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [state.filteredCards[i], state.filteredCards[j]] = [state.filteredCards[j], state.filteredCards[i]];
      }
      state.currentCardIndex = 0;
      displayCurrentCard();
    }

    // Touch events for swipe gestures
    let touchStartX = 0;
    let touchEndX = 0;

    document.getElementById('flashcard')?.addEventListener('touchstart', e => {
      touchStartX = e.changedTouches[0].screenX;
    });

    document.getElementById('flashcard')?.addEventListener('touchend', e => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    });

    function handleSwipe() {
      const swipeThreshold = 50;
      const diff = touchEndX - touchStartX;

      if (Math.abs(diff) > swipeThreshold) {
        if (diff < 0) {
          // Swipe left - mark for review
          markForReview();
        } else {
          // Swipe right - mark as known
          markAsKnown();
        }
      }
    }

    // ============================================
    // SECTION 6.5: 45-SECOND PITCH TIMER LOGIC
    // ============================================

    function initPitchTimer() {
      // Reset to setup screen
      document.getElementById('pitch-setup').style.display = 'block';
      document.getElementById('pitch-running').style.display = 'none';
      document.getElementById('pitch-review').style.display = 'none';

      // Update prompt display
      updatePromptDisplay();

      // Setup time selector buttons
      document.querySelectorAll('.time-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          state.selectedTime = parseInt(this.getAttribute('data-seconds'));
        });
      });

      // Setup START button
      document.getElementById('start-timer-btn').addEventListener('click', startTimer);

      // Setup review buttons
      document.getElementById('try-again-btn').addEventListener('click', () => {
        initPitchTimer();
      });

      document.getElementById('next-prompt-btn').addEventListener('click', () => {
        state.currentPromptIndex = (state.currentPromptIndex + 1) % pitchPrompts.length;
        initPitchTimer();
      });
    }

    function updatePromptDisplay() {
      const prompt = pitchPrompts[state.currentPromptIndex];
      document.getElementById('current-prompt-title').textContent =
        `Prompt ${state.currentPromptIndex + 1} de ${pitchPrompts.length}`;
      document.getElementById('prompt-text').textContent = prompt.prompt;
      document.getElementById('running-prompt').textContent = prompt.prompt;
    }

    function startTimer() {
      // Hide setup, show running screen
      document.getElementById('pitch-setup').style.display = 'none';
      document.getElementById('pitch-running').style.display = 'block';

      // Initialize timer
      state.timerRunning = true;
      state.timerStartTime = performance.now();
      const duration = state.selectedTime * 1000; // Convert to milliseconds

      // Initialize display
      document.getElementById('timer-display').textContent = state.selectedTime;
      document.getElementById('timer-progress').style.width = '0%';
      document.getElementById('wrap-up-message').style.display = 'none';

      // Reset timer classes
      const timerDisplay = document.getElementById('timer-display');
      const progressBar = document.getElementById('timer-progress');
      timerDisplay.className = 'timer-display-large';
      progressBar.className = 'progress-bar';

      let hasVibratedYellow = false;
      let hasVibratedRed = false;

      // Update timer using requestAnimationFrame for accuracy
      function updateTimer() {
        if (!state.timerRunning) return;

        const elapsed = performance.now() - state.timerStartTime;
        const remaining = Math.max(0, duration - elapsed);
        const remainingSeconds = Math.ceil(remaining / 1000);
        const progressPercent = (elapsed / duration) * 100;

        // Update display
        document.getElementById('timer-display').textContent = remainingSeconds;
        document.getElementById('timer-progress').style.width = `${Math.min(100, progressPercent)}%`;

        // Color phases based on progress
        if (progressPercent < 60) {
          // Green phase (0-60%)
          timerDisplay.classList.remove('timer-phase-yellow', 'timer-phase-red');
          timerDisplay.classList.add('timer-phase-green');
          progressBar.classList.remove('progress-yellow', 'progress-red');
          progressBar.classList.add('progress-green');
        } else if (progressPercent < 85) {
          // Yellow phase (60-85%)
          timerDisplay.classList.remove('timer-phase-green', 'timer-phase-red');
          timerDisplay.classList.add('timer-phase-yellow');
          progressBar.classList.remove('progress-green', 'progress-red');
          progressBar.classList.add('progress-yellow');

          // Vibrate once when entering yellow
          if (!hasVibratedYellow && navigator.vibrate) {
            navigator.vibrate(200);
            hasVibratedYellow = true;
          }
        } else {
          // Red phase (85-100%)
          timerDisplay.classList.remove('timer-phase-green', 'timer-phase-yellow');
          timerDisplay.classList.add('timer-phase-red');
          progressBar.classList.remove('progress-green', 'progress-yellow');
          progressBar.classList.add('progress-red');
          document.getElementById('wrap-up-message').style.display = 'block';

          // Vibrate pattern when entering red
          if (!hasVibratedRed && navigator.vibrate) {
            navigator.vibrate([100, 50, 100, 50, 100]);
            hasVibratedRed = true;
          }
        }

        // Check if timer is done
        if (remaining <= 0) {
          state.timerRunning = false;
          showReview();
        } else {
          requestAnimationFrame(updateTimer);
        }
      }

      // Start the timer loop
      requestAnimationFrame(updateTimer);
    }

    function stopTimer() {
      state.timerRunning = false;
      if (state.timerInterval) {
        clearInterval(state.timerInterval);
        state.timerInterval = null;
      }
    }

    function showReview() {
      // Hide running screen, show review screen
      document.getElementById('pitch-running').style.display = 'none';
      document.getElementById('pitch-review').style.display = 'block';

      // Get current prompt
      const prompt = pitchPrompts[state.currentPromptIndex];

      // Populate checklist
      const checklistContainer = document.getElementById('review-checklist');
      checklistContainer.innerHTML = '';
      prompt.checklist.forEach(item => {
        const checkItem = document.createElement('div');
        checkItem.className = 'checklist-item';
        checkItem.innerHTML = `<span class="checkbox">‚òê</span> ${item}`;
        checklistContainer.appendChild(checkItem);
      });

      // Populate ideal script
      document.getElementById('ideal-script-content').textContent = prompt.idealScript;
    }

    // ============================================
    // SECTION 6.6: OBJECTION HANDLING LOGIC
    // ============================================

    function initObjections() {
      // Reset state
      state.currentObjectionIndex = 0;
      state.objectionsAnswered = 0;
      state.objectionsCorrect = 0;

      // Show question screen
      document.getElementById('objection-question').style.display = 'block';
      document.getElementById('objection-feedback').style.display = 'none';
      document.getElementById('objection-complete').style.display = 'none';

      // Setup restart button
      const restartBtn = document.getElementById('restart-objections-btn');
      if (restartBtn) {
        restartBtn.addEventListener('click', initObjections);
      }

      // Show first question
      showObjectionQuestion();
    }

    function showObjectionQuestion() {
      const objection = objections[state.currentObjectionIndex];

      // Update display
      document.getElementById('objection-number').textContent =
        `Obje√ß√£o ${state.currentObjectionIndex + 1} de ${objections.length}`;
      document.getElementById('objection-text').textContent = objection.objection;
      document.getElementById('objection-score').textContent =
        `Score: ${state.objectionsCorrect}/${state.objectionsAnswered}`;

      // Clear and populate options
      const optionsContainer = document.getElementById('objection-options');
      optionsContainer.innerHTML = '';

      objection.options.forEach((option, index) => {
        const optionBtn = document.createElement('button');
        optionBtn.className = 'btn btn-secondary';
        optionBtn.style.textAlign = 'left';
        optionBtn.style.padding = '1rem';
        optionBtn.textContent = String.fromCharCode(65 + index) + '. ' + option.text;
        optionBtn.addEventListener('click', () => selectAnswer(index));
        optionsContainer.appendChild(optionBtn);
      });

      // Start 5-second countdown
      startObjectionTimer();
    }

    function startObjectionTimer() {
      state.objectionTimeRemaining = 5;
      document.getElementById('objection-timer').textContent = state.objectionTimeRemaining;

      // Clear existing timer
      if (state.objectionTimer) {
        clearInterval(state.objectionTimer);
      }

      // Countdown
      state.objectionTimer = setInterval(() => {
        state.objectionTimeRemaining--;
        document.getElementById('objection-timer').textContent = state.objectionTimeRemaining;

        if (state.objectionTimeRemaining <= 0) {
          clearInterval(state.objectionTimer);
          // Auto-select first option (wrong answer) on timeout
          selectAnswer(-1); // -1 indicates timeout
        }
      }, 1000);
    }

    function selectAnswer(selectedIndex) {
      // Stop timer
      if (state.objectionTimer) {
        clearInterval(state.objectionTimer);
        state.objectionTimer = null;
      }

      // Disable all option buttons
      document.querySelectorAll('#objection-options button').forEach(btn => {
        btn.disabled = true;
      });

      // Show feedback
      showObjectionFeedback(selectedIndex);
    }

    function showObjectionFeedback(selectedIndex) {
      const objection = objections[state.currentObjectionIndex];
      state.objectionsAnswered++;

      // Hide question, show feedback
      document.getElementById('objection-question').style.display = 'none';
      document.getElementById('objection-feedback').style.display = 'block';

      // Determine result
      let result, resultColor, score;

      if (selectedIndex === -1) {
        // Timeout
        result = '‚è±Ô∏è Tempo Esgotado!';
        resultColor = 'var(--color-error)';
        score = 0;
      } else {
        score = objection.options[selectedIndex].score;

        if (selectedIndex === objection.correctIndex) {
          result = '‚úÖ Correto!';
          resultColor = 'var(--accent-primary)';
          state.objectionsCorrect++;
        } else if (score === 1) {
          result = '‚ö†Ô∏è Parcial';
          resultColor = 'var(--color-warning)';
        } else {
          result = '‚ùå Errado';
          resultColor = 'var(--color-error)';
        }
      }

      // Display result
      const resultDiv = document.getElementById('feedback-result');
      resultDiv.textContent = result;
      resultDiv.style.color = resultColor;

      // Display explanation
      document.getElementById('feedback-explanation').textContent = objection.explanation;

      // Display ideal script
      document.getElementById('feedback-ideal-script').textContent = objection.idealScript;

      // Update score
      document.getElementById('feedback-score').textContent =
        `Score: ${state.objectionsCorrect}/${state.objectionsAnswered}`;

      // Setup next button
      const nextBtn = document.getElementById('next-objection-btn');
      nextBtn.onclick = nextObjection;
    }

    function nextObjection() {
      state.currentObjectionIndex++;

      if (state.currentObjectionIndex >= objections.length) {
        // Session complete
        showObjectionComplete();
      } else {
        // Show next question
        document.getElementById('objection-feedback').style.display = 'none';
        document.getElementById('objection-question').style.display = 'block';
        showObjectionQuestion();
      }
    }

    function showObjectionComplete() {
      // Hide feedback, show complete screen
      document.getElementById('objection-feedback').style.display = 'none';
      document.getElementById('objection-complete').style.display = 'block';

      // Display final score
      document.getElementById('final-score-display').textContent =
        `${state.objectionsCorrect}/${objections.length}`;
    }

    // ============================================
    // SECTION 7: LOCALSTORAGE PERSISTENCE
    // ============================================

    function saveState() {
      try {
        localStorage.setItem('xai-review-needed', JSON.stringify(state.reviewNeeded));
        localStorage.setItem('xai-known-cards', JSON.stringify(state.knownCards));
        localStorage.setItem('xai-category-filter', document.getElementById('category-filter')?.value || 'all');
      } catch (e) {
        console.warn('Could not save state to localStorage:', e);
      }
    }

    function loadState() {
      try {
        const reviewNeeded = localStorage.getItem('xai-review-needed');
        const knownCards = localStorage.getItem('xai-known-cards');

        if (reviewNeeded) {
          state.reviewNeeded = JSON.parse(reviewNeeded);
        }
        if (knownCards) {
          state.knownCards = JSON.parse(knownCards);
        }
      } catch (e) {
        console.warn('Could not load state from localStorage:', e);
      }
    }

    // ============================================
    // SECTION 8: SERVICE WORKER REGISTRATION
    // ============================================

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('Service Worker registered:', registration);
          })
          .catch(error => {
            console.log('Service Worker registration failed:', error);
          });
      });
    }

    // ============================================
    // SECTION 9: INITIALIZATION
    // ============================================

    document.addEventListener('DOMContentLoaded', () => {
      // Load initial state
      loadState();

      // Navigate to hash or dashboard
      const hash = window.location.hash.slice(1) || 'dashboard';
      navigateTo(hash);

      // Start countdown
      updateCountdown();

      // Display first phrase
      displayPhrase();

      console.log('xAI Pocket Trainer initialized!');
      console.log(`${flashcardsData.length} flashcards loaded`);
      console.log(`Interview: ${INTERVIEW_DATE.toLocaleString('pt-BR')}`);
    });
  </script>
</body>
</html>
